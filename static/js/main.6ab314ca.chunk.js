(this["webpackJsonperacer-portal"]=this["webpackJsonperacer-portal"]||[]).push([[0],{141:function(e,t){},178:function(e,t){},254:function(e,t,n){},263:function(e,t,n){"use strict";n.r(t);var r=n(58),o=n(59),i=n(2),a=n(69),c=n.n(a),s=n(11),l=n(66),d=n(3),j=(n(236),n(142)),b=n(275),u=n(277),p=n(123),x=n.n(p),O=(n(254),n(20),n(184)),h=n.n(O),y=n(280);function f(e,t){var n=Array.from(t);return n[t.findIndex((function(t){return t.key===e.key}))]=e,n}var g=n(89),v=n(16),w=function(e){var t=Object(o.d)("black","white");return Object(v.jsx)(g.b,{onMouseEnter:function(){e.onMap&&e.setWaypoints((function(t){return f(Object(d.a)(Object(d.a)({},e.waypoint),{},{active:!0}),t)}))},onMouseLeave:function(){e.onMap&&e.setWaypoints((function(t){return f(Object(d.a)(Object(d.a)({},e.waypoint),{},{active:!1}),t)}))},size:e.onMap?35:30,style:{translate:e.onMap?"-50% -100%":"",color:"var(--chakra-colors-".concat(e.waypoint.active?t:e.highlight?"yellow-400":"red-500",")"),zIndex:1}})};w.defaultProps={onMap:!1,active:!1};var m=n(81);x.a.workerClass=n(257).default;var I=.9,k=1e3,C=function(e){return new u.a({id:"drive-path-layer",data:[{path:e,name:""}],rounded:!0,pickable:!1,widthScale:2,widthMinPixels:2,widthMaxPixels:6,getColor:[11,197,234]})},S=function(e){var t=Object(o.d)("light","dark"),n=Object(i.useRef)(null),r=function(){var e=Object(i.useState)({width:void 0,height:void 0}),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){function e(){r({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}(),a=r.width,c=r.height,d=Object(i.useCallback)((function(t){e.setWaypoints((function(n){var r,o,i=function(e,t,n){var r=Array.from(n);return r.splice(t,0,e),r}((r=t.coordinate[0],o=t.coordinate[1],{key:Object(y.a)(),lat:o,lon:r,active:!1}),e.insertIndex,n);e.setInsertIndex(e.insertIndex+1);var a=new m.CurveInterpolator(i.map((function(e){return[e.lon,e.lat]})),{tension:I}).getPoints(k);return e.setPolyline({points:a,path:C(a)}),i}))}),[e.insertIndex]);return Object(v.jsx)(l.a,{flex:1,display:"block",ref:n,children:Object(v.jsxs)(b.a,{initialViewState:{latitude:40.440349,longitude:-79.942433,zoom:18,bearing:0,pitch:0,maxZoom:24},controller:{touchRotate:!0,touchZoom:!0},onClick:d,layers:[e.polyline.path],ContextProvider:j.c.Provider,children:[Object(v.jsx)(j.b,{mapStyle:e.satellite?"mapbox://styles/mapbox/satellite-streets-v12":"mapbox://styles/mapbox/".concat(t,"-v11"),width:a,height:c,attributionControl:!1}),Object(v.jsx)(P,{waypoints:e.waypoints,setWaypoints:e.setWaypoints,setPolyline:e.setPolyline,makeDrivePathLayer:C,insertIndex:e.insertIndex,setInsertIndex:e.setInsertIndex})]})})},P=function(e){var t=Object(i.useMemo)((function(){return e.waypoints.map((function(t,n){return Object(v.jsx)(j.a,{longitude:t.lon,latitude:t.lat,draggable:!0,onClick:function(){e.setInsertIndex(n+1)},onDragEnd:function(n){e.setWaypoints((function(r){var o=f(Object(d.a)(Object(d.a)({},t),{},{lat:n.lngLat[1],lon:n.lngLat[0]}),r),i=new m.CurveInterpolator(o.map((function(e){return[e.lon,e.lat]})),{tension:I}).getPoints(k);return e.setPolyline({points:i,path:e.makeDrivePathLayer(i)}),o}))},children:Object(v.jsx)(w,{waypoint:t,setWaypoints:e.setWaypoints,onMap:!0,highlight:n===e.insertIndex-1})},t.key)}))}),[e]);return Object(v.jsx)(v.Fragment,{children:t})},W=n(181),M=n(180),z=function(e){var t=Object(o.c)().toggleColorMode,n=Object(o.d)("dark","light"),r=Object(o.d)(g.c,g.d),i=Object(o.d)("gray.100","gray.700"),a=Object(o.d)("gray.700","gray.100"),c=Object(o.d)("gray.700","gray.200");return Object(v.jsx)(M.c,Object(d.a)({size:"md",fontSize:"lg",variant:"ghost",color:i,bg:a,_hover:{bg:c},marginLeft:"2",onClick:t,icon:Object(v.jsx)(r,{}),"aria-label":"Switch to ".concat(n," mode")},e))},E=n(113),L=function(e){var t=e.satellite?E.b:E.c,n=Object(o.d)("gray.100","gray.700"),r=Object(o.d)("gray.700","gray.100"),i=Object(o.d)("gray.700","gray.200");return Object(v.jsx)(M.c,Object(d.a)({size:"md",fontSize:"lg",variant:"ghost",color:n,bg:r,_hover:{bg:i},marginLeft:"2",onClick:function(){return e.setSatellite(!e.satellite)},icon:Object(v.jsx)(t,{}),"aria-label":"Toggle map/satellite mode"},e.iconProps))},A=function(e){var t=Object(o.d)("gray.800","white"),n=Object(o.d)("gray.700","gray.100"),r=Object(o.d)("gray.100","gray.800"),i=Object(o.d)("gray.400","gray.800"),a=Object(o.d)("gray.500","gray.600");return Object(v.jsxs)(l.b,{w:"100%",bg:t,px:4,py:3,shadow:"dark-lg",pointerEvents:"auto",children:[Object(v.jsx)(l.c,{fontSize:"3xl",ps:2,color:r,children:"ERacer Portal"}),Object(v.jsx)(l.d,{}),Object(v.jsxs)(W.b,{width:450,ms:4,borderColor:i,children:[Object(v.jsx)(W.c,{pointerEvents:"none",fontSize:"1em",color:r,bg:n,children:[Object(v.jsx)(g.a,{},"eracer-globeicon"),Object(v.jsx)(l.e,{ms:3,children:"ws://"},"earcer-wsheader")],borderColor:i}),Object(v.jsx)(W.a,{placeholder:"Websocket Address",_placeholder:{color:a},color:r,borderColor:i,_hover:{borderColor:a}}),Object(v.jsx)(W.d,{w:"fit-content",borderColor:i,children:Object(v.jsx)(M.a,{size:"xs",m:2,colorScheme:"teal",children:"Connect"})})]}),Object(v.jsx)(z,{ms:4}),Object(v.jsx)(L,{iconProps:{ms:4},satellite:e.satellite,setSatellite:e.setSatellite})]})},D=n(143),R=function(e){var t=Object(o.d)(".700",".400"),n=e.setWaypoints,r=Object(i.useCallback)((function(t){var r;void 0!==(null===(r=t.destination)||void 0===r?void 0:r.index)&&n((function(n){var r,o,i,a,c=(o=t.source.index,i=null===(r=t.destination)||void 0===r?void 0:r.index,a=n,h()(a,o,i)),s=new m.CurveInterpolator(c.map((function(e){return[e.lon,e.lat]})),{tension:I}).getPoints(k);return e.setPolyline({points:s,path:C(s)}),c}))}),[n]);return Object(v.jsx)(D.a,{onDragEnd:r,children:Object(v.jsx)(l.a,{h:"100%",style:{overflow:"auto"},children:Object(v.jsx)(D.c,{droppableId:"eracer-waypoints",children:function(n,r){return Object(v.jsxs)(l.a,Object(d.a)(Object(d.a)({ref:n.innerRef},n.droppableProps),{},{children:[e.waypoints.map((function(n,r){return Object(v.jsx)(D.b,{draggableId:n.key,index:r,children:function(o,i){return Object(v.jsx)(l.a,Object(d.a)(Object(d.a)(Object(d.a)({ref:o.innerRef},o.draggableProps),o.dragHandleProps),{},{children:Object(v.jsxs)(l.b,{py:3,borderY:"0.5px solid gray",style:{borderCollapse:"collapse"},alignItems:"center",flexDirection:"row",onMouseEnter:function(){e.setWaypoints((function(e){return f(Object(d.a)(Object(d.a)({},n),{},{active:!0}),e)}))},onMouseLeave:function(){e.setWaypoints((function(e){return f(Object(d.a)(Object(d.a)({},n),{},{active:!1}),e)}))},onClick:function(){e.setInsertIndex(r+1)},pointerEvents:"fill",children:[Object(v.jsx)(l.a,{px:3,children:Object(v.jsx)(E.a,{size:20,cursor:"pointer",onClick:function(){return e.setWaypoints((function(t){var r=function(e,t){var n=Array.from(t);return n.splice(t.findIndex((function(t){return t.key===e.key})),1),n}(n,t),o=r.length?new m.CurveInterpolator(r.map((function(e){return[e.lon,e.lat]})),{tension:I}).getPoints(k):[];return e.setPolyline({points:o,path:C(o)}),r}))}})}),Object(v.jsx)(l.a,{px:2,pl:4,children:Object(v.jsx)(w,{waypoint:n,setWaypoints:e.setWaypoints,highlight:r===e.insertIndex-1})}),Object(v.jsxs)(l.a,{px:2,fontSize:"xs",w:"100%",children:["Lat: ",n.lat.toFixed(6),Object(v.jsx)("br",{}),"Lon: ",n.lon.toFixed(6)]}),Object(v.jsx)(l.a,{px:4,textAlign:"right",fontSize:"md",children:Object(v.jsx)(l.e,{whiteSpace:"nowrap",textColor:"red".concat(t),cursor:"pointer"})})]},n.key)}))}},n.key)})),n.placeholder]}))}})})})},H=n(262),F=function(e){var t=Object(o.d)("gray.300","gray.700"),n=Object(o.d)("gray.400","gray.600"),r=Object(o.d)(".300",".400"),a=e.setWaypoints,c=e.setPolyline,s=Object(i.useCallback)((function(){a((function(){return c({points:[],path:C([])}),[]}))}),[a,c]),d=Object(i.useCallback)((function(){H(JSON.stringify(e.waypoints,null,2),"waypoints.json")}),[e.waypoints]),j=Object(i.useRef)(null),b=Object(i.useCallback)((function(t){var n=t.target.files[0];if(n){var r=new FileReader;r.onload=function(t){a((function(){var n=JSON.parse(t.target.result);if(n.length){var r=new m.CurveInterpolator(n.map((function(e){return[e.lon,e.lat]})),{tension:I}).getPoints(k);c({points:r,path:C(r)}),e.setInsertIndex(n.length)}return n}))},r.readAsText(n)}}),[a,c,e]);return Object(v.jsx)(l.b,{shadow:"dark-lg",rounded:"lg",flex:1,alignSelf:"flex-end",w:"30%",minW:300,maxW:450,m:4,overflow:"hidden",bg:t,pointerEvents:"auto",flexDirection:"column",children:Object(v.jsxs)(l.b,{bg:n,h:300,m:5,rounded:"lg",flexDirection:"column",overflow:"hidden",children:[Object(v.jsxs)(l.b,{bg:"red".concat(r),w:"100%",py:2,px:4,children:[Object(v.jsx)(l.c,{fontSize:"2xl",me:"auto",children:"Waypoints"}),Object(v.jsxs)(M.b,{size:"sm",isAttached:!0,variant:"solid",colorScheme:"blackAlpha",children:[Object(v.jsx)(M.a,{onClick:s,children:"Clear"}),Object(v.jsx)("input",{ref:j,type:"file",onChange:b,style:{display:"none"}}),Object(v.jsx)(M.a,{onClick:function(){return j.current.click()},children:"Load"}),Object(v.jsx)(M.a,{onClick:d,children:"Save"})]})]}),Object(v.jsx)(l.a,{flex:1,style:{overflow:"auto"},children:Object(v.jsx)(R,{waypoints:e.waypoints,setWaypoints:e.setWaypoints,polyline:e.polyline,setPolyline:e.setPolyline,insertIndex:e.insertIndex,setInsertIndex:e.setInsertIndex})})]})})},J=function(){var e=Object(i.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(i.useState)({}),a=Object(s.a)(o,2),c=a[0],d=a[1],j=Object(i.useState)(!0),b=Object(s.a)(j,2),u=b[0],p=b[1],x=Object(i.useState)(0),O=Object(s.a)(x,2),h=O[0],y=O[1];return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(l.b,{minH:"100vh",maxH:"100vh",children:Object(v.jsx)(S,{satellite:u,waypoints:n,setWaypoints:r,polyline:c,setPolyline:d,insertIndex:h,setInsertIndex:y})}),Object(v.jsxs)(l.b,{position:"absolute",top:0,left:0,minH:"100vh",maxH:"100vh",minW:"100vw",maxW:"100vw",direction:"column",textAlign:"center",fontSize:"xl",pointerEvents:"none",children:[Object(v.jsx)(A,{satellite:u,setSatellite:p}),Object(v.jsx)(F,{waypoints:n,setWaypoints:r,polyline:c,setPolyline:d,insertIndex:h,setInsertIndex:y})]})]})},_=Object(r.b)({config:{initialColorMode:"light",useSystemColorMode:!0}});c.a.render(Object(v.jsx)(i.StrictMode,{children:Object(v.jsxs)(r.a,{theme:_,children:[Object(v.jsx)(o.b,{initialColorMode:_.config.initialColorMode}),Object(v.jsx)(J,{})]})}),document.getElementById("root"))}},[[263,1,2]]]);
//# sourceMappingURL=main.6ab314ca.chunk.js.map